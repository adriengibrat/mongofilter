(function(a){function d(a,b,e){var f=a,g=this;c[b]&&(b=c[b]),g.filter=function(a){var b=[];for(var c in a){if(!a.hasOwnProperty(c))continue;g.filterItem(a[c])&&b.push(a[c])}return b},g.filterItem=function(a){typeof a=="string"&&(a=JSON.parse(a));var c=!0,g;switch(b){case"=":case">":case">=":case"<":case"<=":case"!=":case"IN":case"NOT IN":g=a[e];if(b==="IN"||b==="NOT IN"){c=!!~f.indexOf(g),b==="NOT IN"&&(c=!c);break}b==="="?b="===":b==="!="&&(b="!=="),c=(new Function("val","struct","return (val "+b+" struct)?true:false;"))(g,f);break;case"LIKE":case"NOT LIKE":case"REGEX":if(b==="LIKE"||b==="NOT LIKE")f=new RegExp("^"+f.replace(/(^|[^%])%(?!%)/g,function(a,b){return b+".*"}).replace(/(?=[^\\]|^)_/g,function(){return"."})+"$");else if(typeof f=="string"){var h,i;f.replace(/^\/([\s\S]*)\/([igm])?/,function(a,b,c){i=b,h=c}),i||(i=f),f=h?new RegExp(i,h):new RegExp(i)}g=a[e],c=g.toString().match(f)?!0:!1,b==="NOT LIKE"&&(c=!c);break;case"NOR":case"OR":case"AND":var j,k;c=[];for(var l in f)k=l.toString().match(/^\d+$/)?null:l,e&&l.match(/^(OR|AND|NOR)$/)&&(k=e),j=new d(f[l],k,e||b),c.push(j.filterItem(a));b==="OR"?c=!!~c.indexOf(!0):b==="NOR"?c=!~c.indexOf(!0):c=!~c.indexOf(!1);break;default:if(typeof f=="string"||typeof f=="number")c=a[b]===f?!0:!1;else if(f instanceof Array)c=f.indexOf(a[b])!==-1;else{var m=new d(f,"AND",b,e);c=m.filterItem(a)}}return c}}function e(a){typeof a=="string"&&(a=JSON.parse(a));if(!a)throw"Invalid clause";return new d(a,"AND",null)}"use strict";var b=typeof exportNames!="undefined"&&exportNames.jsonFilter||"jsonFilter",c={$gt:">",$gte:">=",$lt:"<",$lte:"<=",$or:"OR","||":"OR",$nor:"NOR",$and:"AND","&&":"AND",$e:"=","<>":"!=",$ne:"!=","!e":"!=",$in:"IN","!in":"NOT IN",$nin:"NOT IN",$regex:"REGEX",$like:"LIKE",$nlike:"NOT LIKE","!like":"NOT LIKE"};typeof a!="undefined"&&(a[b]=e),typeof window!="undefined"&&(window[b]=e)})(typeof exports=="object"&&exports||this)